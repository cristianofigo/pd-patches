#N canvas 1 68 961 522 10;
#X text 11 151 Bonk's two outputs are the raw spectrum of the attack
(provided as a list of 11 numbers giving the signal "loudness" in the
11 frequency bands used) \, and the "cooked" output which gives only
an instrument number (counting up from zero) and a "velocity". The
instrumnent number is significant only if Bonk has a "template set"
in memory.;
#X text 11 8 BONK - an attack detector for small percussion instruments
;
#X text 8 30 The Bonk object takes an audio signal input and looks
for "attacks" defined as sharp changes in the spectral envelope of
the incoming sound. Optionally \, and less reliably \, you can have
Bonk check the attack against a collection of stored templates to try
to guess which of two or more instruments was hit. Bonk is described
theoretically in the 1998 ICMC proceedings \, reprinted on http://man104nfs.ucsd.edu/~mpuckett.
;
#X obj 266 474 print;
#X floatatom 260 396 0 0 0 0 - - -;
#X obj 266 444 spigot;
#X msg 260 366 0;
#X msg 297 366 1;
#X msg 436 322 bang;
#X obj 423 413 bonk~;
#X msg 436 139 learn 1;
#X msg 436 199 learn 0;
#X msg 431 381 print;
#X obj 336 362 adc~;
#X text 266 492 cooked;
#X obj 203 474 print;
#X floatatom 197 396 0 0 0 0 - - -;
#X obj 203 444 spigot;
#X msg 197 366 0;
#X msg 228 366 1;
#X text 203 492 raw;
#X obj 450 444 s bonk-cooked;
#X msg 436 169 learn 10;
#X msg 436 229 forget;
#X msg 436 259 write templates.txt;
#X msg 436 289 read templates.txt;
#X msg 437 15 thresh 6 50;
#X text 205 343 enable printout;
#X msg 437 75 mask 4 0.7;
#X msg 436 109 debounce 0;
#X msg 437 45 minvel 10;
#X msg 431 351 debug 0;
#X text 526 8 Set low and high thresholds. Signal growth must exceed
the high one and then fall to the low one to make an attack.;
#X text 526 41 Minimum velocity to output (quieter notes are ignored.)
;
#X text 525 109 Minimum time (msec) between attacks;
#X text 525 60 Describes how energy in each frequency band masks later
energy in the band. Here the masking is total for 4 analysis periods
and then drops by 0.7 each period.;
#X text 523 134 Forget all templates and start learning new ones. The
argument gives the number of times you will hit each instrument (10
recommended.) Turn on the output volume above for audible feedback
as you train Bonk. "Learn 0" exits learn mode.;
#X text 523 218 Forget the last template. In Learn mode \, use "forget"
to erase and record over a template.;
#X text 588 258 Write templates to a file in text-editable format.
;
#X text 589 288 Read templates from a file.;
#X text 531 383 Print out all settings and templates.;
#X text 531 316 Poll the current spectrum via "raw" outlet \, You can
set a very high threshold if you don't want attacks mixed in.;
#X text 531 356 turn debugging on or off.;
#X text 695 423 For more info \, see the "help" file!;
#X obj 423 474 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X connect 4 0 5 1;
#X connect 5 0 3 0;
#X connect 6 0 4 0;
#X connect 7 0 4 0;
#X connect 8 0 9 0;
#X connect 9 0 17 0;
#X connect 9 0 44 0;
#X connect 9 1 5 0;
#X connect 9 1 21 0;
#X connect 10 0 9 0;
#X connect 11 0 9 0;
#X connect 12 0 9 0;
#X connect 13 0 9 0;
#X connect 13 1 9 0;
#X connect 16 0 17 1;
#X connect 17 0 15 0;
#X connect 18 0 16 0;
#X connect 19 0 16 0;
#X connect 22 0 9 0;
#X connect 23 0 9 0;
#X connect 24 0 9 0;
#X connect 25 0 9 0;
#X connect 26 0 9 0;
#X connect 28 0 9 0;
#X connect 29 0 9 0;
#X connect 30 0 9 0;
#X connect 31 0 9 0;
